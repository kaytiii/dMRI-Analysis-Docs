#########################################################
#
# Masking CSF out of Lesion Filled Segments
# Kayti Keith
# 3/6/19
#
#########################################################

#for ID in A201 A202 A203 A204 A205 A206 A208 A209 A211 A212 A213 A215 A216 A218 A220 A221 A222 A223 A224 A226 A227 A228 A229 A230 A231 A231 A232 A233 A234 A235 A236 A237 A238 A239 A241 A242 A243 A244 A245 A246 A247 A248 A249 A251 A252 A253 A254 A255 A256 A258 A260 A261 A262 A263 A265 A266 A267 A268 A270 A271 A272 A273 A274 A275 A276 A277 A278 A279 A280 A281 A282 A283 A285 A286 A287 A288 A289 A290 A291 A292 A292 A293 A294 A295 A298 A299 A300 A302 A304 A305 A306 A307 A308 A309 A310 A311 A201_FU A203_FU A204_FU A205_FU A206_FU A209_FU A211_FU A212_FU A215_FU A216_FU A221_FU A222_FU A223_FU A224_FU A226_FU A227_FU A228_FU A229_FU A230_FU A232_FU A234_FU A235_FU A238_FU A239_FU A240_FU A242_FU A243_FU A244_FU A246_FU A247_FU A248_FU A251_FU A252_FU A253_FU A254_FU A256_FU A258_FU A260_FU A262_FU A263_FU A265_FU A267_FU A270_FU A272_FU A273_FU A276_FU A277_FU A278_FU A279_FU A281_FU A283_FU A285_FU A288_FU A290_FU A291_FU A292_FU ; do

export segs=/Users/keith/Desktop/MIND/Filled_Segment_Analysis/03_Analysis/02_Warped_Segments
export mdmap=/Users/keith/Desktop/MIND/Filled_Segment_Analysis/02_Cases/02_DKE_Maps 
export dkemaps=/Volumes/research/benitez/MIND_shared/_MIND/MRI_Processed/MIND_DKE_2.6_2018

# md mask creation
for ID in A201 A202 A203 A204 A205 A206 A208 A209 A211 A212 A213 A215 A216 A218 A220 A221 A222 A223 A224 A226 A227 A228 A229 A230 A231 A231 A232 A233 A234 A235 A236 A237 A238 A239 A241 A242 A243 A244 A245 A246 A247 A248 A249 A251 A252 A253 A254 A255 A256 A258 A260 A261 A262 A263 A265 A266 A267 A268 A270 A271 A272 A273 A274 A275 A276 A277 A278 A279 A280 A281 A282 A283 A285 A286 A287 A288 A289 A290 A291 A292 A292 A293 A294 A295 A298 A299 A300 A302 A304 A305 A306 A307 A308 A309 A310 A311 A201_FU A203_FU A204_FU A205_FU A206_FU A209_FU A211_FU A212_FU A215_FU A216_FU A221_FU A222_FU A223_FU A224_FU A226_FU A227_FU A228_FU A229_FU A230_FU A232_FU A234_FU A235_FU A238_FU A239_FU A240_FU A242_FU A243_FU A244_FU A246_FU A247_FU A248_FU A251_FU A252_FU A253_FU A254_FU A256_FU A258_FU A260_FU A262_FU A263_FU A265_FU A267_FU A270_FU A272_FU A273_FU A276_FU A277_FU A278_FU A279_FU A281_FU A283_FU A285_FU A288_FU A290_FU A291_FU A292_FU ; do
for mets in dax drad dmean kax krad kmean wmm_awf wmm_da wmm_de_ax wmm_de_rad wmm_tort ; do
cp $dkemaps/${ID}/dke_2018_06/${mets}.nii $mdmap/${ID}/${ID}_${mets}.nii
fslmaths $mdmap/${ID}/${ID}_dmean.nii -uthr 2 -bin $mdmap/${ID}/${ID}_md_mask.nii
gunzip $mdmap/${ID}/${ID}_md_mask.nii.gz
done

# wm csf masking
#fslmaths $mdmap/${ID}/${ID}_md_mask.nii -mul $segs/${ID}/${ID}_filled_WM_095.nii $segs/${ID}/${ID}_filled_WM_095_masked.nii
#gunzip $segs/${ID}/${ID}_filled_WM_095_masked.nii.gz
#gm csf masking
#fslmaths $mdmap/${ID}/${ID}_md_mask.nii -mul $segs/${ID}/${ID}_filled_GM_095.nii $segs/${ID}/${ID}_filled_GM_095_masked.nii
#gunzip $segs/${ID}/${ID}_filled_GM_095_masked.nii.gz
#done
